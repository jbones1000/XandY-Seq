#N canvas 325 170 1299 780 10;
#X obj 248 131 inlet notes;
#X obj 518 131 inlet print-toggle;
#X text 36 5 arg1: unique number;
#X text 36 25 arg2: 0: 16ths 1: 8ths 2: quarters 3: swing 12ths;
#X obj 55 131 inlet knobx;
#X obj 151 131 inlet knoby;
#X obj 193 706 outlet;
#X text 317 673 play the recorded sequence;
#X obj 698 131 inlet aux-play;
#N canvas 142 112 883 829 write-the-txt 1;
#X obj 20 24 inlet x;
#X obj 90 24 inlet y;
#X obj 255 27 inlet notes;
#X obj 130 259 t a a, f 7;
#X obj 154 395 i;
#X obj 400 388 i;
#X obj 137 432 / 16;
#X obj 347 425 / 16;
#X obj 489 79 loadbang;
#X obj 56 588 text set xyseq-\$1-X;
#X msg 489 157 list dummy x;
#X obj 489 179 t a b;
#X msg 571 224 0;
#X obj 611 177 t a b;
#X msg 647 227 1;
#X obj 489 119 t b b;
#X msg 611 155 list length 5;
#X obj 266 588 text set xyseq-\$1-Y;
#X obj 488 290 loadbang;
#X msg 488 368 list dummy x;
#X obj 488 390 t a b;
#X msg 571 435 0;
#X obj 610 388 t a b;
#X msg 647 438 1;
#X obj 488 330 t b b;
#X msg 610 366 list length 5;
#X obj 488 470 text set xyseq-\$1-Y, f 29;
#X obj 489 259 text set xyseq-\$1-X, f 29;
#X msg 348 284 list nichts;
#X text 319 52 hold note longer than 500 delete;
#N canvas 24 50 766 473 check-for-hold 0;
#X obj 149 29 inlet;
#X obj 220 444 outlet;
#X obj 220 372 f;
#X msg 312 263 stop;
#X obj 149 150 unpack;
#X obj 188 218 sel 0;
#X obj 220 245 bang;
#X obj 220 293 t b f;
#X obj 188 182 t f b;
#X obj 220 344 del 500;
#X msg 220 267 1;
#X obj 149 51 t a a;
#X obj 181 74 stripnote;
#X obj 181 96 pack 0 0;
#X obj 63 376 outlet;
#X connect 0 0 11 0;
#X connect 2 0 1 0;
#X connect 3 0 9 0;
#X connect 4 1 8 0;
#X connect 5 1 6 0;
#X connect 6 0 10 0;
#X connect 7 0 9 0;
#X connect 7 1 2 1;
#X connect 8 0 5 0;
#X connect 8 1 3 0;
#X connect 9 0 2 0;
#X connect 10 0 7 0;
#X connect 11 0 4 0;
#X connect 11 1 12 0;
#X connect 12 0 13 0;
#X connect 12 1 13 1;
#X connect 13 0 14 0;
#X restore 261 148 pd check-for-hold;
#X obj 403 203 s \$0-led;
#X obj 371 176 t b f;
#X obj 56 511 list prepend note;
#X obj 56 489 list prepend;
#X obj 266 501 list prepend note;
#X obj 266 479 list prepend;
#X obj 209 556 + 2;
#X obj 431 533 + 2;
#X obj 137 454 + 1;
#X obj 347 447 + 1;
#X obj 20 126 * 64;
#X obj 90 126 * 64;
#X obj 189 293 unpack 0 0;
#X obj 189 316 + 12;
#X obj 189 338 pack 0 0;
#X obj 570 68 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X connect 0 0 41 0;
#X connect 1 0 42 0;
#X connect 2 0 30 0;
#X connect 3 0 34 0;
#X connect 3 1 43 0;
#X connect 4 0 6 0;
#X connect 4 0 37 0;
#X connect 5 0 7 0;
#X connect 5 0 38 0;
#X connect 6 0 39 0;
#X connect 7 0 40 0;
#X connect 8 0 15 0;
#X connect 10 0 11 0;
#X connect 11 0 27 0;
#X connect 11 1 12 0;
#X connect 12 0 27 1;
#X connect 13 0 27 0;
#X connect 13 1 14 0;
#X connect 14 0 27 1;
#X connect 15 0 10 0;
#X connect 15 1 16 0;
#X connect 16 0 13 0;
#X connect 18 0 24 0;
#X connect 19 0 20 0;
#X connect 20 0 26 0;
#X connect 20 1 21 0;
#X connect 21 0 26 1;
#X connect 22 0 26 0;
#X connect 22 1 23 0;
#X connect 23 0 26 1;
#X connect 24 0 19 0;
#X connect 24 1 25 0;
#X connect 25 0 22 0;
#X connect 28 0 17 0;
#X connect 28 0 9 0;
#X connect 30 0 3 0;
#X connect 30 1 32 0;
#X connect 32 0 28 0;
#X connect 32 1 31 0;
#X connect 33 0 9 0;
#X connect 34 0 33 0;
#X connect 35 0 17 0;
#X connect 36 0 35 0;
#X connect 37 0 9 1;
#X connect 38 0 17 1;
#X connect 39 0 34 1;
#X connect 40 0 36 1;
#X connect 41 0 4 0;
#X connect 42 0 5 0;
#X connect 43 0 44 0;
#X connect 43 1 45 1;
#X connect 44 0 45 0;
#X connect 45 0 36 0;
#X connect 46 0 15 0;
#X connect 46 0 24 0;
#X restore 55 187 pd write-the-txt - - - - - -;
#N canvas 107 50 1635 928 play-the-txts 0;
#X obj 542 890 outlet;
#X obj 465 149 sel 0 1, f 10;
#X msg 550 484 0 \, 1 \, 2;
#X obj 618 830 bag;
#X msg 644 798 flush;
#X obj 542 732 t a a;
#X obj 618 852 pack 0 0;
#X obj 582 435 s \$0-flush;
#X obj 644 772 r \$0-flush;
#X obj 342 217 r cg-beat-clock;
#X obj 675 199 loadbang;
#X msg 675 256 1;
#N canvas 4 50 1905 999 seq-clocker 0;
#N canvas 9 50 1241 632 clock-control 0;
#X obj 15 63 inlet;
#X obj 297 57 inlet;
#X obj 400 57 inlet;
#X obj 188 432 outlet;
#X obj 516 55 inlet;
#X text 343 58 stop;
#X text 446 58 start;
#X obj 403 442 outlet;
#X text 248 433 beat clock out;
#X text 558 57 start on next beat;
#X obj 695 58 inlet;
#X text 742 57 loop ctrl;
#X obj 836 58 inlet;
#X text 57 60 beat clock in;
#X obj 298 98 bang;
#X obj 398 89 bang;
#X obj 516 85 bang;
#X msg 299 124 0;
#X obj 414 124 t b b;
#X obj 423 322 t b b;
#N canvas 502 270 450 300 wait-for-next-beat 0;
#X obj 109 71 inlet;
#X obj 211 67 inlet;
#X obj 118 215 outlet;
#X obj 114 137 == 1;
#X obj 114 115 i 0;
#X obj 114 162 sel 1;
#X obj 114 184 t b b;
#X msg 166 152 0;
#X msg 203 92 1;
#X connect 0 0 4 0;
#X connect 1 0 8 0;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 6 1 7 0;
#X connect 7 0 4 1;
#X connect 8 0 4 1;
#X restore 386 297 pd wait-for-next-beat;
#X msg 467 360 1;
#X msg 445 156 1;
#X obj 773 437 outlet;
#X text 833 436 spigot control;
#X obj 748 234 spigot 1;
#X obj 798 184 ==;
#X obj 756 271 bang;
#X msg 757 297 0;
#X text 813 234 if loop off \, shut off seq clock output at end;
#X text 883 56 seq end in;
#X text 460 443 seq clock start;
#X obj 40 98 t f f;
#X obj 169 179 <;
#X obj 169 205 sel 1;
#X obj 172 144 t f f;
#X text 212 187 bang on next rollover \, top of beat;
#X connect 0 0 32 0;
#X connect 1 0 14 0;
#X connect 2 0 15 0;
#X connect 4 0 16 0;
#X connect 10 0 26 0;
#X connect 12 0 25 0;
#X connect 14 0 17 0;
#X connect 15 0 18 0;
#X connect 16 0 20 1;
#X connect 17 0 23 0;
#X connect 18 0 7 0;
#X connect 18 1 22 0;
#X connect 19 0 7 0;
#X connect 19 1 21 0;
#X connect 20 0 19 0;
#X connect 21 0 23 0;
#X connect 22 0 23 0;
#X connect 25 0 27 0;
#X connect 26 0 25 1;
#X connect 27 0 28 0;
#X connect 28 0 23 0;
#X connect 32 0 3 0;
#X connect 32 1 35 0;
#X connect 33 0 34 0;
#X connect 34 0 20 0;
#X connect 35 0 33 1;
#X connect 35 1 33 0;
#X restore 211 199 pd clock-control;
#X obj 457 97 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X text 284 22 start;
#X text 347 19 start on next beat;
#X text 531 23 loop;
#X obj 236 342 spigot;
#N canvas 226 50 1124 809 clocker 0;
#X obj 312 332 wrap;
#X floatatom 339 413 5 0 0 0 - - -, f 5;
#X obj 458 134 t b b;
#X obj 453 82 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 936 330 5 0 0 0 - - -, f 5;
#X obj 312 310 - 0;
#X obj 314 215 f;
#X obj 312 355 t f f;
#X obj 273 690 outlet;
#X obj 271 608 + 1;
#X obj 453 53 inlet;
#X obj 993 50 inlet;
#X text 1040 51 length;
#X obj 311 61 inlet;
#X obj 352 688 outlet;
#X text 40 321 derive an internal beat clock from the master by offsetting
phase., f 34;
#X text 392 538 bang at end;
#X obj 332 506 >= 4;
#X obj 312 438 + 0;
#X text 47 609 send out seq clock. for the last value send out 1 cause
if looping this would be where it wraps around., f 33;
#N canvas 0 50 450 300 wait-for-next-tick 0;
#X obj 109 71 inlet;
#X obj 211 67 inlet;
#X obj 118 215 outlet;
#X obj 114 137 == 1;
#X obj 114 115 i 0;
#X obj 114 162 sel 1;
#X obj 114 184 t b b;
#X msg 166 152 0;
#X msg 203 92 1;
#X connect 0 0 4 0;
#X connect 1 0 8 0;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 6 1 7 0;
#X connect 7 0 4 1;
#X connect 8 0 4 1;
#X restore 313 176 pd wait-for-next-tick;
#X text 503 50 start;
#X obj 517 165 t b b;
#X obj 340 536 sel 1 0;
#X obj 290 572 f;
#X obj 312 467 t f f;
#X msg 319 611 1;
#X obj 402 665 s \$0-loop;
#X obj 515 137 r \$0-loop;
#X obj 473 618 f;
#X obj 473 643 - 4;
#X obj 347 248 f;
#X obj 347 281 - 0;
#X obj 345 573 t b b b b;
#X obj 303 103 t f b f f;
#N canvas 80 99 660 336 count-beats 0;
#X obj 175 216 + 1;
#X msg 230 99 0;
#X obj 126 152 <;
#X obj 126 178 sel 1;
#X obj 129 117 t f f;
#X obj 141 219 i 1;
#X text 225 151 when current value is lees than previous value the
phasor rolled over and we increment the beat count.;
#X obj 125 47 inlet;
#X obj 136 269 outlet;
#X obj 303 37 inlet;
#X text 171 44 beat clock in;
#X text 348 38 reset;
#X text 184 271 count;
#X connect 0 0 5 1;
#X connect 1 0 2 1;
#X connect 1 0 5 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 2 1;
#X connect 4 1 2 0;
#X connect 5 0 0 0;
#X connect 5 0 8 0;
#X connect 7 0 4 0;
#X connect 9 0 1 0;
#X restore 339 387 pd count-beats;
#X text 443 366 when phasor is reset from a start condition or rollover
\, reset beat counter., f 25;
#X text 356 64 beat clock;
#X obj 473 669 s \$0-overshoot;
#X obj 385 245 r \$0-overshoot;
#X text 87 461 add beat count to beat phase;
#X text 509 244 subtract the overshoot amount from below (the amount
the sequence clock advanced beyond the sequence length);
#X text 555 59 when we start the sequence we want the first output
to be 1 (top of first beat) \, so we wait for next tick.;
#X text 175 701 seq clock out;
#X text 432 704 bang at end of sequence. this gets sent out before
the seq clock. since the sequence clock just loops \, this is useful
for shutting off the output externally (spigot) if you just want a
seuqnce to play once;
#X floatatom 573 670 10 0 0 0 - - -, f 10;
#X text 28 55 this patch takes a 0-1 beat phase clock input and outputs
a sequence clock of arbitrary length that is syncrhonized to the input
clock., f 38;
#X text 29 159 it corrects for overshoot when the clock doesn't exactly
equal the length., f 38;
#X text 593 145 on loop \, the last value (equal to sequence length)
is acutally the top of the next loop \, so we use the previous beat
phase value as the offset.;
#X text 560 597 we can't depend on the sequence clock (which is based
on the input beat phasor) being exactly equal to the sequence length.
so if it advances past the sequence length \, subtract this overshoot
on the next loop to keep everything in sync.;
#X text 29 119 the sequence clock goes from 1 to len+1 and loops continuously
, f 38;
#X connect 0 0 7 0;
#X connect 1 0 18 1;
#X connect 2 0 20 1;
#X connect 2 1 35 1;
#X connect 3 0 2 0;
#X connect 4 0 17 1;
#X connect 4 0 30 1;
#X connect 5 0 0 0;
#X connect 6 0 5 1;
#X connect 7 0 18 0;
#X connect 7 1 35 0;
#X connect 9 0 8 0;
#X connect 10 0 3 0;
#X connect 11 0 4 0;
#X connect 13 0 34 0;
#X connect 17 0 23 0;
#X connect 18 0 25 0;
#X connect 20 0 6 0;
#X connect 22 0 31 0;
#X connect 22 1 35 1;
#X connect 23 0 33 0;
#X connect 23 1 24 0;
#X connect 24 0 9 0;
#X connect 25 0 17 0;
#X connect 25 1 24 1;
#X connect 25 1 29 1;
#X connect 26 0 8 0;
#X connect 28 0 22 0;
#X connect 29 0 30 0;
#X connect 30 0 38 0;
#X connect 30 0 45 0;
#X connect 31 0 32 0;
#X connect 32 0 5 1;
#X connect 33 0 26 0;
#X connect 33 1 14 0;
#X connect 33 2 27 0;
#X connect 33 3 29 0;
#X connect 34 0 5 0;
#X connect 34 1 20 0;
#X connect 34 2 6 1;
#X connect 34 3 31 1;
#X connect 35 0 1 0;
#X connect 39 0 32 1;
#X restore 211 281 pd clocker;
#X obj 420 461 outlet;
#X obj 323 464 outlet;
#X obj 584 63 inlet;
#X text 624 63 length;
#X obj 75 42 inlet;
#X obj 257 238 t b b;
#X obj 360 325 t b b;
#X obj 234 457 outlet;
#X text 180 491 seq clock out;
#X text 312 490 seq starting;
#X text 418 489 seq ended;
#X text 115 44 beat clock;
#X obj 228 50 inlet;
#X obj 284 48 inlet;
#X obj 368 46 inlet;
#X obj 502 45 inlet;
#X text 221 23 stop;
#X text 392 272 the clocker just loops forever. it sends out a bang
at the end of each loop that we can use to shut off its output if we
don't want a looping clock.;
#X obj 395 395 spigot;
#X obj 584 85 - 1;
#X connect 0 0 6 0;
#X connect 0 1 12 0;
#X connect 0 2 5 1;
#X connect 0 2 25 1;
#X connect 1 0 0 4;
#X connect 5 0 14 0;
#X connect 6 0 5 0;
#X connect 6 1 13 0;
#X connect 9 0 26 0;
#X connect 11 0 0 0;
#X connect 12 0 6 1;
#X connect 12 1 8 0;
#X connect 13 0 0 5;
#X connect 13 1 25 0;
#X connect 19 0 0 1;
#X connect 20 0 0 2;
#X connect 21 0 0 3;
#X connect 22 0 1 0;
#X connect 25 0 7 0;
#X connect 26 0 6 2;
#X restore 342 280 pd seq-clocker - - - - - - - - - - - - - - - - -
- - - - - - - -;
#X obj 532 188 t b;
#X text 995 401 bang knobs evey loop to preserve where they are set
too;
#X text 528 602 play the stores text file;
#X floatatom 838 323 5 0 0 0 - - -, f 5;
#X obj 550 400 t b b;
#X text 917 597 play the stores text file;
#X obj 342 315 t f f;
#X obj 542 709 route note;
#X obj 507 631 s length-\$0;
#X obj 759 252 r length-\$0;
#X obj 934 49 inlet;
#X obj 342 602 cg-seq-player xyseq-\$1-X;
#X obj 731 597 cg-seq-player xyseq-\$1-Y;
#X connect 1 0 13 0;
#X connect 1 1 12 3;
#X connect 1 2 13 0;
#X connect 2 0 24 1;
#X connect 2 0 25 1;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 5 0 0 0;
#X connect 5 1 3 0;
#X connect 6 0 0 0;
#X connect 8 0 4 0;
#X connect 9 0 12 0;
#X connect 10 0 11 0;
#X connect 11 0 12 4;
#X connect 12 0 19 0;
#X connect 12 1 17 0;
#X connect 12 2 17 0;
#X connect 13 0 12 1;
#X connect 17 0 2 0;
#X connect 17 1 7 0;
#X connect 19 0 24 0;
#X connect 19 1 25 0;
#X connect 20 0 5 0;
#X connect 22 0 12 5;
#X connect 22 0 16 0;
#X connect 23 0 1 0;
#X connect 24 0 20 0;
#X connect 24 1 21 0;
#X connect 25 0 20 0;
#X restore 193 672 pd play-the-txts;
#X obj 551 418 text define xyseq-\$1-X;
#X obj 724 418 text define xyseq-\$1-Y;
#X msg 724 368 write \$1y.txt;
#X msg 734 396 read \$1y.txt;
#X msg 551 369 write \$1x.txt;
#X msg 569 392 read \$1x.txt;
#X obj 734 305 loadbang;
#X obj 551 319 r saveState;
#X obj 703 660 r \$0-led;
#X obj 703 702 outlet led;
#X obj 301 445 text set xyseq-\$1-X;
#X obj 346 352 + 1;
#X obj 307 351 f 2;
#X msg 325 327 2;
#X msg 301 408 list nichts;
#X obj 307 373 t b f;
#X obj 297 283 t f b;
#X obj 297 305 until;
#X msg 298 234 64;
#X obj 199 350 + 1;
#X obj 160 349 f 2;
#X msg 178 325 2;
#X msg 154 406 list nichts;
#X obj 160 371 t b f;
#X obj 150 281 t f b;
#X obj 150 303 until;
#X msg 151 232 64;
#X obj 154 443 text set xyseq-\$1-Y;
#X connect 0 0 9 2;
#X connect 4 0 9 0;
#X connect 5 0 9 1;
#X connect 8 0 10 0;
#X connect 10 0 6 0;
#X connect 13 0 12 0;
#X connect 14 0 12 0;
#X connect 15 0 11 0;
#X connect 16 0 11 0;
#X connect 17 0 16 0;
#X connect 17 0 14 0;
#X connect 18 0 15 0;
#X connect 18 0 13 0;
#X connect 19 0 20 0;
#X connect 22 0 23 1;
#X connect 23 0 22 0;
#X connect 23 0 26 0;
#X connect 24 0 23 1;
#X connect 25 0 21 0;
#X connect 26 0 25 0;
#X connect 26 1 21 1;
#X connect 27 0 28 0;
#X connect 27 1 24 0;
#X connect 28 0 23 0;
#X connect 29 0 27 0;
#X connect 30 0 31 1;
#X connect 31 0 30 0;
#X connect 31 0 34 0;
#X connect 32 0 31 1;
#X connect 33 0 38 0;
#X connect 34 0 33 0;
#X connect 34 1 38 1;
#X connect 35 0 36 0;
#X connect 35 1 32 0;
#X connect 36 0 31 0;
#X connect 37 0 35 0;
